<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">

    <!-- Circles' head scripts [REQUIRED] -->
    <circles-start-scripts/>
    <!-- Physics script goes after the Circles' head scripts [IMPORTANT]-->
    <script src="/global/js/libs/aframe-physics-system.min.js"></script>
    <script src="/worlds/KIN_FreeFall/components/physics-object.js"></script>
    <script src="/worlds/KIN_FreeFall/components/collision-indicator.js"></script>
    <script src="/worlds/KIN_FreeFall/scripts/experiment-functions.js"></script>
  </head>

  <body onload="setup()">
    <!-- this is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
    <circles-start-ui/>

    <!-- a-scene with 'circles-properties' component [REQUIRED] -->
    <a-scene circles_scene_properties>

      <a-camera position="0 1.6 0" rotation="0 0 0"></a-camera>
      <!-- assets -->
      <a-assets timeout="10000">
        <!-- credit: HDRMaps @ https://hdrmaps.com/above-the-clouds/ -->
        <img id='skyMap' src='assets/images/086_hdrmaps_com_free_above_clouds.jpg' crossorigin="anonymous">

        <!-- narration, for some reason when I add this it messes with the spawn point????
        <audio id="Narr_welcome" src="assets/audio/narr_welcome.mp3" preload="true"></audio>-->

        <!-- Models -->
          <a-asset-item id="CPUTerminal_obj" src="/worlds/MM_CreativeMode/assets/models/CPUTerminal.obj"></a-asset-item>
          <a-asset-item id="CPUTerminal_mtl" src="/worlds/MM_CreativeMode/assets/models/CPUTerminal.mtl"></a-asset-item>
          <a-asset-item id="northernElectricPhone_obj" src="/worlds/MM_CreativeMode/assets/models/northernElectricPhone.obj"></a-asset-item>
          <a-asset-item id="northernElectricPhone_mtl" src="/worlds/MM_CreativeMode/assets/models/northernElectricPhone.mtl"></a-asset-item>

        <!-- Environment -->
        <a-asset-item id="room_gltf" src="assets/models/room.gltf" crossorigin="anonymous"></a-asset-item>

        <!-- Images -->

        <!-- Hub image -->
        <img id='hub360' src='/worlds/MuseumMysteriesHub/assets/images/MMHubIMG.png' crossorigin="anonymous">

        <!-- Circles' built-in assets [REQUIRED] -->
        <circles-assets/>
      </a-assets>

      <!-- Circles' built-in manager and avatar [REQUIRED] -->
      <circles-manager-avatar/>

      <!-- Back to hub -->
        <a-entity class="backToLabel" position="0 -10.3 0" rotation="0 0 180" text="value:Back to; color: #025d96; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/BebasNeue-Regular-msdf.json; negate: false; lineHeight: 60"  scale="4.5 4.5 4.5"></a-entity>
        <a-entity class="panelLabel" position="0 -9.6 0" rotation="0 0 180" text="value:Hub; color: #025d96; width: 1.7; wrapCount: 30; align: center; tabSize: 4.43; font: /worlds/KIN_FreeFall/assets/font/BebasNeue-Regular-msdf.json; negate: false; lineHeight: 60"  scale="5 5 5"></a-entity>
      </a-entity>

      <!-- Floor -->
      <a-entity id="floor" position="0 -1 0"  geometry="primitive:box; depth:30; width:30; height:1;" material="color:#63A350;" body="type:static; mass:0; shape:box;" circles-shadow></a-entity>

      <a-entity id="room" 
                gltf-model="#room_gltf"
                position="0 0 0"
                shadow></a-entity>

      <a-entity obj-model="obj: #CPUTerminal_obj; mtl: #CPUTerminal_mtl" position="-2.8 1 9" rotation="0 -90 0"
                shadow="cast:true; receive:true;"></a-entity>

        <a-entity obj-model="obj: #northernElectricPhone_obj; mtl: #northernElectricPhone_mtl"
                  position="9.5 1 6"
                  shadow="cast:true; receive:true;"></a-entity>                  


      <!-- Portal to back to experiment Hub -->
      <a-entity id="HubLink"
            position="14 1.5 8" rotation="0 180 0" scale="1 1 1"
            circles-portal="img_src:#hub360; title_text:Click me to be teleported; link_url:/w/MuseumMysteriesHub"></a-entity>
            
      </a-entity>

      <!-- Checkpoints -->
      <a-entity circles-checkpoint circles-spawnpoint position="12 0.05 8"></a-entity>
      <a-entity circles-checkpoint position="0 0.05 0"></a-entity>
      <a-entity circles-checkpoint position="-3.5 0.05 -1.7"></a-entity>
      <a-entity circles-checkpoint position="3.5 0.05 -1.7"></a-entity>

      <a-entity id="bkShelveCHK01" circles-checkpoint position="-5 0.05 -7"></a-entity>
      <a-entity id="bkShelveCHK02" circles-checkpoint position="-2 0.05 -7"></a-entity>
      <a-entity id="bkShelveCHK03" circles-checkpoint position="0 0.05 -7"></a-entity>
      <a-entity id="bkShelveCHK04" circles-checkpoint position="2 0.05 -7"></a-entity>
      <a-entity id="bkShelveCHK05" circles-checkpoint position="5 0.05 -7"></a-entity>
      <a-entity id="beakersCHK01" circles-checkpoint position="-5 0.05 -10.5"></a-entity>
      <a-entity id="beakersCHK02" circles-checkpoint position="-2 0.05 -10.5"></a-entity>
      <a-entity id="beakersCHK03" circles-checkpoint position="0 0.05 -10.5"></a-entity>
      <a-entity id="beakersCHK04" circles-checkpoint position="2 0.05 -10.5"></a-entity>
      <a-entity id="beakersCHK05" circles-checkpoint position="5 0.05 -10.5"></a-entity>

      <a-entity light="type:ambient; color:#FFF; intensity:3.0"></a-entity>
      <a-entity light="type: directional; color: #FFF; intensity: 1.0" position="0 1 1"></a-entity>
      <a-entity light="type: spot; color: #FFF; intensity: 1.0" position="10 5 6" rotation="-90 0 0"></a-entity>
      <a-entity id='skyBox'
                rotation='0 200 0'
                geometry='primitive:sphere; radius:50; segments-height:24; segments-width:24;'
                material='shader:flat; src:#skyMap; side:back;'>
      </a-entity>
    </a-scene>

    <!-- Circles' end scripts [REQUIRED] -->
    <circles-end-scripts/>
  </body>
</html>
