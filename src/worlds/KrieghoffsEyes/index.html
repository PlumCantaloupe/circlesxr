<html>
  <head>
    <!-- Circles' head scripts [REQUIRED] -->
    <circles-start-scripts />
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aframe-physics-system/4.0.1/aframe-physics-system.min.js"></script>
    <script src="assets/scripts/change-environment.js"></script>
    <script src="assets/scripts/painting-highlight.js"></script>
    <script src="assets/scripts/info-panel.js"></script>
  </head>
  <body>
    <!-- this is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
    <circles-start-ui />

    <!-- a-scene with physics for collision -->
    <a-scene circles_scene_properties physics="gravity: 0">
      <a-assets>
        <!-- Circles' built-in assets [REQUIRED] -->
        <a-asset-item
          id="chair_1_gltf"
          src="/worlds/KrieghoffsEyes/assets/models/chair.gltf"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="easle_and_painting_gltf"
          src="/worlds/KrieghoffsEyes/assets/models/easle_and_painting.gltf"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="painting_1_gltf"
          src="/worlds/KrieghoffsEyes/assets/models/painting.gltf"
          responnse-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <circles-assets />
      </a-assets>

      <a-entity id="GameManager" change-environment></a-entity>

      <!-- Circles' built-in manager and avatar [REQUIRED] -->
      <circles-manager-avatar />

      <!-- Circles' built-in manager and avatar [REQUIRED] -->

      <a-entity
        id="environment"
        environment="preset: checkerboard; seed: 123; skyType: gradient; skyColor: #0f0c14; horizonColor: #000000; lighting: none; dressing: none;"
      ></a-entity>
      <!-- Ambient lighting inside the cabin -->
      <a-entity light="type: ambient; intensity: 0.5"></a-entity>

      <!-- Cabin Structure with Collision -->
      <a-box
        position="0 1.5 -9"
        width="10"
        height="3"
        depth="0.2"
        color="#8B5A2B"
      ></a-box>
      <!-- Back Wall -->
      <a-box
        position="-5 1.5 -4"
        width="0.2"
        height="3"
        depth="10"
        color="#8B5A2B"
      ></a-box>
      <!-- Left Wall -->
      <a-box
        position="5 1.5 -4"
        width="0.2"
        height="3"
        depth="10"
        color="#8B5A2B"
      ></a-box>
      <!-- Right Wall -->
      <a-box
        position="0 1.5 1"
        width="10"
        height="3"
        depth="0.2"
        color="#8B5A2B"
      ></a-box>
      <!-- Back Wall -->
      <a-box
        position="0 3 -4"
        width="10"
        height="0.2"
        depth="10"
        color="#704214"
      ></a-box>
      <!-- Roof -->
      <a-box
        position="0 0 -4"
        width="10"
        height="0.2"
        depth="10"
        color="#654321"
      ></a-box>
      <!-- Floor -->

      <!-- Lights inside the cabin 
    <a-entity light="type: point; intensity: 3; distance: 5" position="-4 2 -8" circles-interactive-object="type:highlight"></a-entity>
    <a-entity light="type: point; intensity: 3; distance: 5" position="0 2 -8" circles-interactive-object="type:highlight"></a-entity>
    <a-entity light="type: point; intensity: 3; distance: 5" position="4 2 -8" circles-interactive-object="type:highlight"></a-entity>
    -->

      <a-entity
        light="distance: 5; intensity: 3; type: point"
        position="-0.93859 1.97876 -4.44843"
        circles-interactive-object=""
        class="interactive"
        scale=""
        circles-material-extend-fresnel="fresnelPow: 2; fresnelOpacity: 0"
        sound="volume: 0.5"
      ></a-entity>

      <!-- Painting -->
      <a-box
        position="4 1.86 -8.866"
        scale=".95 1.3 .071"
        color="#940000"
        id="redPaint"
        class="interactive"
        circles-interactive-object="type:highlight"
        environemntProp="preset: forest; seed: 222; skyType: atmosphere;  lighting: distant; dressing: trees;"
        painting-highlight
        material="emissive: #fff700; emissiveIntensity: 0;"
      ></a-box>
      <a-box
        position="0 1.86 -8.866"
        scale=".95 1.3 .071"
        color="#009400"
        id="greenPaint"
        class="interactive"
        circles-interactive-object="type:highlight"
        painting-highlight
        material="emissive: #fff700; emissiveIntensity: 0;"
      ></a-box>
      <a-box
        position="-4 1.86 -8.866"
        scale=".95 1.3 .071"
        color="#000094"
        id="bluePaint"
        class="interactive"
        circles-interactive-object="type:highlight"
        circles-sendpoint="target:#checkpoint_blue;"
        environemntProp="preset: japan; seed: 222; skyType: atmosphere;  lighting: distant; dressing: torii;"
        painting-highlight
        material="emissive: #fff700; emissiveIntensity: 0;"
      ></a-box>

      <a-entity
        id="checkpoint_red"
        circles-checkpoint
        position="20 0.105 0"
      ></a-entity>
      <a-entity
        id="checkpoint_blue"
        circles-checkpoint
        position="-40 0.105 0"
      ></a-entity>

      <!-- models -->
      <a-entity
        position="2.78254 0 -5.84547"
        rotation="0 11.506138441817194 0"
        scale="20 20 20"
        gltf-model="/worlds/KrieghoffsEyes/assets/models/chair.gltf"
      ></a-entity>
      <a-entity
        scale="20 20 20"
        gltf-model="#easle_and_painting_gltf"
        position="2.69453 0 -5.4894"
        rotation="0 -38.35895142621349 0"
      ></a-entity>
      <a-entity
        scale="20 20 20"
        gltf-model="#painting_1_gltf"
        position="-2.85013 0 -4.29198"
        rotation="0 -46.65824508868346 0"
      ></a-entity>
      <a-entity
        scale="20 20 20"
        gltf-model="#painting_1_gltf"
        position="-1.05372 0 -5.11934"
        rotation="0 -82.69671744461711 0"
      ></a-entity>
      <a-entity
        scale="20 20 20"
        gltf-model="#painting_1_gltf"
        position="0.90896 0 -4.31538"
        rotation="0 -130.53239080229443 0"
      ></a-entity>

      <a-plane
        id="navmesh"
        visible="false"
        position="0 .105 -4"
        rotation="-90 0 0"
        scale=".95 9.4 1"
        width="10"
        depth="10"
        color="#FFFFFF"
        nav-mesh
      ></a-plane>
      <a-plane
        id="navmeshred"
        visible="false"
        position="20 .105 0"
        rotation="-90 0 0"
        scale=".95 9.4 1"
        width="10"
        depth="10"
        color="#FFFFFF"
        nav-mesh
      ></a-plane>
      <a-plane
        id="navmeshblue"
        visible="false"
        position="-40 .105 0"
        rotation="-90 0 0"
        scale=".95 9.4 1"
        width="10"
        depth="10"
        color="#FFFFFF"
        nav-mesh
      ></a-plane>

      <!-- Responsive UI -->
      <!-- Background element used for UI interactions -->
      <a-entity
        id="background"
        position="0 0 0"
        geometry="primitive: sphere; radius: 2.0"
        material="color: red; side: back; shader: flat"
        scale="0.001 0.001 0.001"
        visible="false"
        class="raycastable"
      >
      </a-entity>

      <a-entity
        id="fadeBackground"
        geometry="primitive: sphere; radius: 2.5"
        material="color: #999999; side: back; shader: flat; blending: subtractive;"
        visible="false"
      >
      </a-entity>

      <!-- Info Panel for displaying painting details -->
      <a-entity
        id="infoPanel"
        info-panel
        position="0 1.6 -2.5"
        geometry="primitive: plane; width: 1.5; height: 1.8"
        material="color: #333; shader: flat; side: double"
        visible="false"
      >
        <!-- Text elements inside the info panel -->
        <a-entity
          id="panelTitle"
          position="-0.68 0.5 0"
          text="anchor: left; width: 1.5; color: white; value:"
        >
          <a-entity
            id="button"
            geometry="primitive: cylinder"
            position="0.7 -0.955 0.030"
            scale="0.082 0.082 0.08346"
            material="color:#a22020;"
            rotation="-90 0 0"
            class="interactive"
            highlight-button
          >
          </a-entity>
        </a-entity>
        <a-entity
          id="panelDescription"
          position="-0.68 0.3 0"
          text="anchor: left; width: 1.5; color: white; value:"
        ></a-entity>
      </a-entity>
    </a-scene>

    <!-- Circles' end scripts [REQUIRED] -->
    <circles-end-scripts />
  </body>
</html>
