<html>
<head>
  <!-- Circles' head scripts [REQUIRED] -->
  <circles-start-scripts/>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.5.4/dist/aframe-extras.min.js"></script>
  <script src="https://unpkg.com/aframe-environment-component@1.3.3/dist/aframe-environment-component.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-physics-system@v4.2.3/dist/aframe-physics-system.min.js"></script>
  <script src="http://kripken.github.io/ammo.js/builds/ammo.wasm.js"></script>
  <script src="assets/scripts/change-environment.js"></script>
  <script src="assets/scripts/RIAmanager.js"></script>
  <script src="assets/scripts/painting-highlight.js"></script>
  <script src="assets/scripts/info-panel.js"></script>
  <script src="assets/scripts/voting-listener.js"></script>
</head>
<body>
  <!-- this is used to create our enter UI that creates a 2D overlay to capture a user gesture for sound/mic access etc. -->
  <circles-start-ui/>

  <!-- a-scene with physics for collision -->
  <a-scene circles_scene_properties physics="gravity: 0; debug: false" >
    <a-assets>
      <!-- Circles' built-in assets [REQUIRED] -->
      <circles-assets/>
      <a-asset-item id ="logModel" src="assets/models/RIA/Log.glb"></a-asset-item>
      <a-asset-item id ="Raft1" src="assets/models/RIA/Raft1.glb"></a-asset-item>
      <a-asset-item id ="Raft2" src="assets/models/RIA/Raft2.glb"></a-asset-item>
      <a-asset-item id ="Raft3" src="assets/models/RIA/Raft3.glb"></a-asset-item>
      <a-asset-item id ="Raft4" src="assets/models/RIA/Raft4.glb"></a-asset-item>
      <a-asset-item
          id="chair_1_gltf"
          src="/worlds/KrieghoffsEyes/assets/models/chair.gltf"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="easle_and_painting_gltf"
          src="/worlds/KrieghoffsEyes/assets/models/easle_and_painting.gltf"
          response-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <a-asset-item
          id="painting_1_gltf"
          src="/worlds/KrieghoffsEyes/assets/models/painting.gltf"
          responnse-type="arraybuffer"
          crossorigin="anonymous"
        ></a-asset-item>
        <circles-assets />
    </a-assets>

        <!-- Circles' built-in manager and avatar [REQUIRED] -->
    <circles-manager-avatar/>

    <!-- Circles' built-in manager and avatar [REQUIRED] -->

    <a-entity id = "environment" environment="preset: checkerboard; seed: 123; skyType: gradient; skyColor: #0f0c14; horizonColor: #000000; lighting: none; dressing: none;"></a-entity>

    <a-entity id="GameManager" 
             
              ria-manager 
              voting-listener
    ></a-entity>

    <a-entity id="Cabin" visible="true">
    <!-- Point lighting inside the cabin -->
    <a-entity 
    light="type: point; color: #FF8C42; intensity: 2.5; distance: 10; decay: 1.2; castShadow: true"
    position=".7 1.8 -3">
    </a-entity>

      <!-- Cabin Structure with Collision -->
      <a-box position="0 1.5 -9" width="10" height="3" depth="0.2"  src="assets/textures/Woodtextures/worn_planks_disp_2k.png" repeat="4 1" ></a-box>  <!-- Back Wall -->
      <a-box position="-5 1.5 -4" width="0.2" height="3" depth="10" src="assets/textures/Woodtextures/worn_planks_disp_2k.png" repeat="4 1"></a-box>  <!-- Left Wall -->
      <a-box position="5 1.5 -4" width="0.2" height="3" depth="10" src="assets/textures/Woodtextures/worn_planks_disp_2k.png" repeat="4 1"></a-box>  <!-- Right Wall -->
      <a-box position="0 1.5 1" width="10" height="3" depth="0.2"  src="assets/textures/Woodtextures/worn_planks_disp_2k.png" repeat="4 1"></a-box>  <!-- Back Wall -->
      <a-box position="0 3 -4" width="10" height="0.2" depth="10"  src="assets/textures/Woodtextures/worn_planks_disp_2k.png" repeat="4 1"></a-box>  <!-- Roof -->
      <a-box position="0 -0.586 -4" width="10" height="0.2" depth="10" material="src: assets/textures/Woodtextures/worn_planks_disp_2k.png; repeat: 6.89 -6.97; normalMap: assets/textures/Woodtextures/worn_planks_nor_2k.png; displacementMap: assets/textures/Woodtextures/worn_planks_arm_2k.png" ></a-box>  <!-- Floor -->
      <!-- Lights inside the cabin 
      <a-entity light="type: point; intensity: 3; distance: 5" position="-4 2 -8" circles-interactive-object="type:highlight"></a-entity>
      <a-entity light="type: point; intensity: 3; distance: 5" position="0 2 -8" circles-interactive-object="type:highlight"></a-entity>
      <a-entity light="type: point; intensity: 3; distance: 5" position="4 2 -8" circles-interactive-object="type:highlight"></a-entity>
      -->

      <!-- Vote Counters Above Each Painting -->
      <a-entity
        id="voteCounter_redPaint"
        position="0.89307 2.7 -4.2979"
        rotation="-15.487622160181282 -38.13320605493194 0.3472124238492789"
        text="value: Votes: 0; align: center; color: white; width: 4"
      >
      </a-entity>
      <a-entity
        id="voteCounter_greenPaint"
        position="-1.06558 2.7 -5.12713"
        rotation="-15.103740437443632 6.330037720605334 0.4125296124941928"
        text="value: Votes: 0; align: center; color: white; width: 4"
      >
      </a-entity>
      <a-entity
        id="voteCounter_bluePaint"
        position="-4 2.7 -8.866"
        text="value: Votes: 0; align: center; color: white; width: 4"
      >
      </a-entity>

      <a-entity
        position="-0.93859 1.97876 -4.44843"
        circles-interactive-object=""
        class="interactive"
        scale=""
        circles-material-extend-fresnel="fresnelPow: 2; fresnelOpacity: 0"
        sound="volume: 0.5"
      ></a-entity>

    <!-- Painting -->
    <a-box
    position="0.89307 1.31338 -4.2979"
    scale="1 1.3 0.071"
    rotation="-15.487622160181282 -38.13320605493194 0.3472124238492789"
    color="#940000"
    id="redPaint"
    class="interactive"
    circles-interactive-object="type:highlight"
    environemntProp="preset: forest; seed: 222; skyType: atmosphere;  lighting: distant; dressing: trees;"
    painting-highlight
    material="emissive: #fff700; emissiveIntensity: 0;"
  ></a-box>
  <a-box
    position="-1.06558 1.33932 -5.12713"
    scale="1 1.3 0.071"
    rotation="-15.103740437443632 6.330037720605334 0.4125296124941928"
    color="#009400"
    id="greenPaint"
    class="interactive"
    circles-interactive-object="type:highlight"
    painting-highlight
    material="emissive: #fff700; emissiveIntensity: 0;"
  ></a-box>
  <a-box
    position="-2.86388 1.33563 -4.2867"
    scale="1 1.3 0.071"
    rotation="-15.513978218757302 42.626914042142985 0.9035544429213082"
    color="#000094"
    id="bluePaint"
    class="interactive"
    circles-interactive-object="type:highlight"
    circles-sendpoint="target:#checkpoint_blue;"
    environemntProp="preset: japan; seed: 222; skyType: atmosphere;  lighting: distant; dressing: torii;"
    painting-highlight
    material="emissive: #fff700; emissiveIntensity: 0;"
  ></a-box>


  <!-- Checkpoints -->
  <a-entity
    id="checkpoint_red"
    circles-checkpoint
    position="20 0.105 0"
  ></a-entity>
  <a-entity
    id="checkpoint_blue"
    circles-checkpoint
    position="-40 0.105 0"
  ></a-entity>
   
  <!-- models -->
  <a-entity
    position="2.78254 0 -5.84547"
    rotation="0 11.506138441817194 0"
    scale="20 20 20"
    gltf-model="/worlds/KrieghoffsEyes/assets/models/chair.gltf"
  ></a-entity>
  <a-entity
    scale="20 20 20"
    gltf-model="#easle_and_painting_gltf"
    position="2.69453 0 -5.4894"
    rotation="0 -38.35895142621349 0"
  ></a-entity>
  <a-entity
    scale="20 20 20"
    gltf-model="#painting_1_gltf"
    position="-2.85013 0 -4.29198"
    rotation="0 -46.65824508868346 0"
  ></a-entity>
  <a-entity
    scale="20 20 20"
    gltf-model="#painting_1_gltf"
    position="-1.05372 0 -5.11934"
    rotation="0 -82.69671744461711 0"
  ></a-entity>
  <a-entity
    scale="20 20 20"
    gltf-model="#painting_1_gltf"
    position="0.90896 0 -4.31538"
    rotation="0 -130.53239080229443 0"
  ></a-entity>


<!-- Responsive UI -->
      <!-- Background element used for UI interactions -->
      <a-entity
        id="background"
        position="0 0 0"
        geometry="primitive: sphere; radius: 2.0"
        material="color: red; side: back; shader: flat"
        scale="0.001 0.001 0.001"
        visible="false"
        class="raycastable"
      >
      </a-entity>

      <a-entity
        id="fadeBackground"
        geometry="primitive: sphere; radius: 2.5"
        material="color: #999999; side: back; shader: flat; blending: subtractive;"
        visible="false"
      >
      </a-entity>

      <!-- Info Panel for displaying painting details -->
      <a-entity
        id="infoPanel"
        info-panel
        position="0 1.6 -2.5"
        geometry="primitive: plane; width: 1.5; height: 1.8"
        material="color: #333; shader: flat; side: double"
        visible="false"
      >
        <!-- Text elements inside the info panel -->
        <a-entity
          id="panelTitle"
          position="-0.68 0.5 0"
          text="anchor: left; width: 1.5; color: white; value:"
        >
          <a-entity
            id="button"
            geometry="primitive: cylinder"
            position="0.7 -0.955 0.030"
            scale="0.082 0.082 0.08346"
            material="color:#a22020;"
            rotation="-90 0 0"
            class="interactive"
            highlight-button
          >
          </a-entity>
        </a-entity>
        <a-entity
          id="panelDescription"
          position="-0.68 0.3 0"
          text="anchor: left; width: 1.5; color: white; value:"
        ></a-entity>
      </a-entity>

  </a-scene>

  <!-- Circles' end scripts [REQUIRED] -->
  <circles-end-scripts/>
</body>
</html>
